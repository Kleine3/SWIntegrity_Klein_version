/**
 * Java OS Injection Vulnerability class
 *
 * @author Kristelle Lucero
 */

import java.util.LinkedList;
import java.util.List;

public class JavaOSInjectionVulnerability implements Vulnerability {

	/*
	* This method analyzes the code for the possibility of Operating System Injection
	*/
	public List<Integer> run(Analyzer ana){
		JavaAnalyzer javaAn = (JavaAnalyzer) ana;

		String osImports[] = {"java.lang", "java.io"}; //these packages are the most likely to call OS commands
		String osCommands[] = {"runtime.getruntime"}; //these commands are commonly exploited
		String osWhiteList[] = {}; //if the code contains a white list of acceptable characters then it is at less risk of OS injection
		
		String contents = "";
		String currentLine = "";
		ArrayList<Integer> vulnLines = new ArrayList<>(); //a list of line numbers that the vulnerability was found on
		
		try {
				BufferedReader br = new BufferedReader(new FileReader(fileName));

				while ((currentLine = br.readLine()) != null) {
					contents += currentLine;
				}

				//checks the two java library api imports see if being used
				//if no then skips all analysis to return false no vulnerabilities
				if (contents.contains("java.lang") || contents.contains("java.io")) {
					contents = contents.toLowerCase();

				}

				
			} catch (IOException e) {
				System.out.println("FileNotFoundException in "
						+ "Java OS analyze");
			}
		return vulnLines;
	}
}