import org.junit.Before;
import org.junit.Test;

import java.util.List;

import static org.junit.Assert.*;

public class AdaDanglingPointerVulnerabilityTest {
    private AdaAnalyzer aana= new AdaAnalyzer();;
    private List<Integer> testList;
    private AdaDanglingPointerVulnerability adp;

    @Before
    public void start(){
        adp = new AdaDanglingPointerVulnerability();
    }

    @Test
    public void testPositive(){
        aana.parse("TestFiles/helloAccessTypes.adb");
        testList = adp.run(aana);
        assertTrue(testList.contains(17));
        assertTrue(testList.contains(24));
        assertTrue(testList.size() == 2);
    }

    @Test
    public void testNegative(){
        aana.parse("TestFiles/hello.adb");
        testList = adp.run(aana);
        assertTrue(testList.size() == 0);
    }
}